PROMPT 7:
INPUT:
mysql> select * from EMP;
+-------+----------+-----------+------------+----------+------------+------+------+
| EMPNO | ENAME    | JOB       | HIREDATE   | SALARY   | COMMISSION | MGR  | DPT  |
+-------+----------+-----------+------------+----------+------------+------+------+
|  1001 | STARK    | MANAGER   | 1995-06-05 | 40000.00 |       NULL | 1005 |   30 |
|  1002 | JOHN     | SALESMAN  | 1993-08-02 | 12000.00 |    1200.00 | 1003 |   10 |
|  1003 | BALLEY   | MANAGER   | 1991-01-10 | 42000.00 |       NULL | 1005 |   10 |
|  1004 | SMITH    | CLERK     | 1998-03-26 | 10000.00 |       0.00 | 1001 |   30 |
|  1005 | ALASTAIR | PRESIDENT | 1994-11-08 | 65000.00 |       NULL | NULL |   20 |
|  1006 | STEVE    | ANALYST   | 1996-11-18 | 30000.00 |       NULL | 1003 |   40 |
|  1007 | JOE      | SALESMAN  | 1996-09-18 | 30000.00 |   12045.00 | 1006 |   40 |
|  1008 | NATHAN   | CLERK     | 2004-11-06 | 10000.00 |   15000.00 | 1003 |   10 |
+-------+----------+-----------+------------+----------+------------+------+------+
8 rows in set (0.00 sec)
QUERY:
mysql> SELECT ENAME,JOB,SALARY FROM EMP
    -> WHERE MGR IS NOT NULL;
OUTPUT:
+--------+----------+----------+
| ENAME  | JOB      | SALARY   |
+--------+----------+----------+
| STARK  | MANAGER  | 40000.00 |
| JOHN   | SALESMAN | 12000.00 |
| BALLEY | MANAGER  | 42000.00 |
| SMITH  | CLERK    | 10000.00 |
| STEVE  | ANALYST  | 30000.00 |
| JOE    | SALESMAN | 30000.00 |
| NATHAN | CLERK    | 10000.00 |
+--------+----------+----------+

PROMPT 08:
INPUT:
+-------+----------+-----------+------------+----------+------------+------+------+
| EMPNO | ENAME    | JOB       | HIREDATE   | SALARY   | COMMISSION | MGR  | DPT  |
+-------+----------+-----------+------------+----------+------------+------+------+
|  1001 | STARK    | MANAGER   | 1995-06-05 | 40000.00 |       NULL | 1005 |   30 |
|  1002 | JOHN     | SALESMAN  | 1993-08-02 | 12000.00 |    1200.00 | 1003 |   10 |
|  1003 | BALLEY   | MANAGER   | 1991-01-10 | 42000.00 |       NULL | 1005 |   10 |
|  1004 | SMITH    | CLERK     | 1998-03-26 | 10000.00 |       0.00 | 1001 |   30 |
|  1005 | ALASTAIR | PRESIDENT | 1994-11-08 | 65000.00 |       NULL | NULL |   20 |
|  1006 | STEVE    | ANALYST   | 1996-11-18 | 30000.00 |       NULL | 1003 |   40 |
|  1007 | JOE      | SALESMAN  | 1996-09-18 | 30000.00 |   12045.00 | 1006 |   40 |
|  1008 | NATHAN   | CLERK     | 2004-11-06 | 10000.00 |   15000.00 | 1003 |   10 |
+-------+----------+-----------+------------+----------+------------+------+------+
QUERY:
mysql> SELECT `ENAME`,`SALARY`*12 AS ANNUAL_SALARY,COMMISSION
    -> FROM EMP
    -> WHERE SALARY > COMMISSION AND JOB="CLERK"
    -> ORDER BY SALARY DESC;
OUTPUT:
+-------+---------------+------------+
| ENAME | ANNUAL_SALARY | COMMISSION |
+-------+---------------+------------+
| SMITH |     120000.00 |       0.00 |
+-------+---------------+------------+
1 row in set (0.00 sec)

PROMPT 09:
INPUT:
+-------+----------+-----------+------------+----------+------------+------+------+
| EMPNO | ENAME    | JOB       | HIREDATE   | SALARY   | COMMISSION | MGR  | DPT  |
+-------+----------+-----------+------------+----------+------------+------+------+
|  1001 | STARK    | MANAGER   | 1995-06-05 | 40000.00 |       NULL | 1005 |   30 |
|  1002 | JOHN     | SALESMAN  | 1993-08-02 | 12000.00 |    1200.00 | 1003 |   10 |
|  1003 | BALLEY   | MANAGER   | 1991-01-10 | 42000.00 |       NULL | 1005 |   10 |
|  1004 | SMITH    | CLERK     | 1998-03-26 | 10000.00 |       0.00 | 1001 |   30 |
|  1005 | ALASTAIR | PRESIDENT | 1994-11-08 | 65000.00 |       NULL | NULL |   20 |
|  1006 | STEVE    | ANALYST   | 1996-11-18 | 30000.00 |       NULL | 1003 |   40 |
|  1007 | JOE      | SALESMAN  | 1996-09-18 | 30000.00 |   12045.00 | 1006 |   40 |
|  1008 | NATHAN   | CLERK     | 2004-11-06 | 10000.00 |   15000.00 | 1003 |   10 |
+-------+----------+-----------+------------+----------+------------+------+------+

QUERY:
mysql> SELECT DPT,COUNT(*) as NO_OF_EMPLOYEES
    -> FROM EMP
    -> GROUP BY DPT;
OUTPUT:
+------+-----------------+
| DPT  | NO_OF_EMPLOYEES |
+------+-----------------+
|   10 |               3 |
|   20 |               1 |
|   30 |               2 |
|   40 |               2 |
+------+-----------------+
4 rows in set (0.00 sec)

PROMPT 10:
INPUT:
mysql> SELECT * FROM EMP;
+-------+----------+-----------+------------+----------+------------+------+------+
| EMPNO | ENAME    | JOB       | HIREDATE   | SALARY   | COMMISSION | MGR  | DPT  |
+-------+----------+-----------+------------+----------+------------+------+------+
|  1001 | STARK    | MANAGER   | 1995-06-05 | 40000.00 |       NULL | 1005 |   30 |
|  1002 | JOHN     | SALESMAN  | 1993-08-02 | 12000.00 |    1200.00 | 1003 |   10 |
|  1003 | BALLEY   | MANAGER   | 1991-01-10 | 42000.00 |       NULL | 1005 |   10 |
|  1004 | SMITH    | CLERK     | 1998-03-26 | 10000.00 |       0.00 | 1001 |   30 |
|  1005 | ALASTAIR | PRESIDENT | 1994-11-08 | 65000.00 |       NULL | NULL |   20 |
|  1006 | STEVE    | ANALYST   | 1996-11-18 | 30000.00 |       NULL | 1003 |   40 |
|  1007 | JOE      | SALESMAN  | 1996-09-18 | 30000.00 |   12045.00 | 1006 |   40 |
|  1008 | NATHAN   | CLERK     | 2004-11-06 | 10000.00 |   15000.00 | 1003 |   10 |
|  1009 | BRUCE    | CLERK     | 2005-10-24 | 12000.00 |   20000.00 | 1003 |   10 |
+-------+----------+-----------+------------+----------+------------+------+------+
9 rows in set (0.00 sec)
PROMPT:
mysql> SELECT AVG(SALARY) AS AVERAGE_SALARY,DPT
    -> FROM EMP
    -> GROUP BY DPT HAVING COUNT(*)>3;
OUTPUT:
+----------------+------+
| AVERAGE_SALARY | DPT  |
+----------------+------+
|   19000.000000 |   10 |
+----------------+------+
1 row in set (0.00 sec)

PROMPT 11:
INPUT:
mysql> SELECT * FROM EMP;
+-------+----------+-----------+------------+----------+------------+------+------+
| EMPNO | ENAME    | JOB       | HIREDATE   | SALARY   | COMMISSION | MGR  | DPT  |
+-------+----------+-----------+------------+----------+------------+------+------+
|  1001 | STARK    | MANAGER   | 1995-06-05 | 40000.00 |       NULL | 1005 |   30 |
|  1002 | JOHN     | SALESMAN  | 1993-08-02 | 12000.00 |    1200.00 | 1003 |   10 |
|  1003 | BALLEY   | MANAGER   | 1991-01-10 | 42000.00 |       NULL | 1005 |   10 |
|  1004 | SMITH    | CLERK     | 1998-03-26 | 10000.00 |       0.00 | 1001 |   30 |
|  1005 | ALASTAIR | PRESIDENT | 1994-11-08 | 65000.00 |       NULL | NULL |   20 |
|  1006 | STEVE    | ANALYST   | 1996-11-18 | 30000.00 |       NULL | 1003 |   40 |
|  1007 | JOE      | SALESMAN  | 1996-09-18 | 30000.00 |   12045.00 | 1006 |   40 |
|  1008 | NATHAN   | CLERK     | 2004-11-06 | 10000.00 |   15000.00 | 1003 |   10 |
|  1009 | BRUCE    | CLERK     | 2005-10-24 | 12000.00 |   20000.00 | 1003 |   10 |
+-------+----------+-----------+------------+----------+------------+------+------+
9 rows in set (0.00 sec)
QUERY:
mysql> SELECT JOB,ENAME,EMPNO
    -> FROM EMP
    -> WHERE (SALARY+COALESCE(COMMISSION,0))>=20000;
OUTPUT:
+-----------+----------+-------+
| JOB       | ENAME    | EMPNO |
+-----------+----------+-------+
| MANAGER   | STARK    |  1001 |
| MANAGER   | BALLEY   |  1003 |
| PRESIDENT | ALASTAIR |  1005 |
| ANALYST   | STEVE    |  1006 |
| SALESMAN  | JOE      |  1007 |
| CLERK     | NATHAN   |  1008 |
| CLERK     | BRUCE    |  1009 |
+-----------+----------+-------+
7 rows in set (0.00 sec)
PROMPT 12:*IMPORTANT DEMONSTRATION OF GROUP BY CLAUSE AND AGGREGATE FUNCTIONS*
INPUT:
+-------+----------+-----------+------------+----------+------------+------+------+
| EMPNO | ENAME    | JOB       | HIREDATE   | SALARY   | COMMISSION | MGR  | DPT  |
+-------+----------+-----------+------------+----------+------------+------+------+
|  1001 | STARK    | MANAGER   | 1995-06-05 | 40000.00 |       NULL | 1005 |   30 |
|  1002 | JOHN     | SALESMAN  | 1993-08-02 | 12000.00 |    1200.00 | 1003 |   10 |
|  1003 | BALLEY   | MANAGER   | 1991-01-10 | 42000.00 |       NULL | 1005 |   10 |
|  1004 | SMITH    | CLERK     | 1998-03-26 | 10000.00 |       0.00 | 1001 |   30 |
|  1005 | ALASTAIR | PRESIDENT | 1994-11-08 | 65000.00 |       NULL | NULL |   20 |
|  1006 | STEVE    | ANALYST   | 1996-11-18 | 30000.00 |       NULL | 1003 |   40 |
|  1007 | JOE      | SALESMAN  | 1996-09-18 | 30000.00 |   12045.00 | 1006 |   40 |
|  1008 | NATHAN   | CLERK     | 2004-11-06 | 10000.00 |   15000.00 | 1003 |   10 |
|  1009 | BRUCE    | CLERK     | 2005-10-24 | 12000.00 |   20000.00 | 1003 |   10 |
+-------+----------+-----------+------------+----------+------------+------+------+
QUERY:
mysql> SELECT DPT,SUM(SALARY+COALESCE(COMMISSION,0)) as TOTAL_PAYABLE_SLRY 
    -> FROM EMP
    -> GROUP By DPT;
OUTPUT:
+------+--------------------+
| DPT  | TOTAL_PAYABLE_SLRY |
+------+--------------------+
|   10 |          112200.00 |
|   20 |           65000.00 |
|   30 |           50000.00 |
|   40 |           72045.00 |
+------+--------------------+
4 rows in set (0.01 sec)

PROMPT 14:
INPUT:
+-------+----------+-----------+------------+----------+------------+------+------+
| EMPNO | ENAME    | JOB       | HIREDATE   | SALARY   | COMMISSION | MGR  | DPT  |
+-------+----------+-----------+------------+----------+------------+------+------+
|  1001 | STARK    | MANAGER   | 1995-06-05 | 40000.00 |       NULL | 1005 |   30 |
|  1002 | JOHN     | SALESMAN  | 1993-08-02 | 12000.00 |    1200.00 | 1003 |   10 |
|  1003 | BALLEY   | MANAGER   | 1991-01-10 | 42000.00 |       NULL | 1005 |   10 |
|  1004 | SMITH    | CLERK     | 1998-03-26 | 10000.00 |       0.00 | 1001 |   30 |
|  1005 | ALASTAIR | PRESIDENT | 1994-11-08 | 65000.00 |       NULL | NULL |   20 |
|  1006 | STEVE    | ANALYST   | 1996-11-18 | 30000.00 |       NULL | 1003 |   40 |
|  1007 | JOE      | SALESMAN  | 1996-09-18 | 30000.00 |   12045.00 | 1006 |   40 |
|  1008 | NATHAN   | CLERK     | 2004-11-06 | 10000.00 |   15000.00 | 1003 |   10 |
|  1009 | BRUCE    | CLERK     | 2005-10-24 | 12000.00 |   20000.00 | 1003 |   10 |
+-------+----------+-----------+------------+----------+------------+------+------+
QUERY:
mysql> SELECT JOB,COUNT(*) as NO_OF_EMP FROM EMP
    -> GROUP BY JOB
    -> ORDER BY COUNT(*) DESC;
OUTPUT:
+-----------+-----------+
| JOB       | NO_OF_EMP |
+-----------+-----------+
| CLERK     |         3 |
| MANAGER   |         2 |
| SALESMAN  |         2 |
| PRESIDENT |         1 |
| ANALYST   |         1 |
+-----------+-----------+
5 rows in set (0.02 sec)

PROMPT 15:
INPUT:
mysql> SELECT * FROM EMP;
+-------+----------+-----------+------------+----------+------------+------+------+
| EMPNO | ENAME    | JOB       | HIREDATE   | SALARY   | COMMISSION | MGR  | DPT  |
+-------+----------+-----------+------------+----------+------------+------+------+
|  1001 | STARK    | MANAGER   | 1995-06-05 | 40000.00 |       NULL | 1005 |   30 |
|  1002 | JOHN     | SALESMAN  | 1993-08-02 | 12000.00 |    1200.00 | 1003 |   10 |
|  1003 | BALLEY   | MANAGER   | 1991-01-10 | 42000.00 |       NULL | 1005 |   10 |
|  1004 | SMITH    | CLERK     | 1998-03-26 | 10000.00 |       0.00 | 1001 |   30 |
|  1005 | ALASTAIR | PRESIDENT | 1994-11-08 | 65000.00 |       NULL | NULL |   20 |
|  1006 | STEVE    | ANALYST   | 1996-11-18 | 30000.00 |       NULL | 1003 |   40 |
|  1007 | JOE      | SALESMAN  | 1996-09-18 | 30000.00 |   12045.00 | 1006 |   40 |
|  1008 | NATHAN   | CLERK     | 2004-11-06 | 10000.00 |   15000.00 | 1003 |   10 |
|  1009 | BRUCE    | CLERK     | 2005-10-24 | 12000.00 |   20000.00 | 1003 |   10 |
+-------+----------+-----------+------------+----------+------------+------+------+
9 rows in set (0.00 sec)
QUERY:
mysql> SELECT AVG(SALARY) as AVG_SAL, JOB FROM EMP
    -> GROUP BY JOB HAVING JOB!="MANAGER";
OUTPUT:
+--------------+-----------+
| AVG_SAL      | JOB       |
+--------------+-----------+
| 21000.000000 | SALESMAN  |
| 10666.666667 | CLERK     |
| 65000.000000 | PRESIDENT |
| 30000.000000 | ANALYST   |
+--------------+-----------+
4 rows in set (0.00 sec)

PROMPT 16:
INPUT:
+-------+----------+-----------+------------+----------+------------+------+------+
| EMPNO | ENAME    | JOB       | HIREDATE   | SALARY   | COMMISSION | MGR  | DPT  |
+-------+----------+-----------+------------+----------+------------+------+------+
|  1001 | STARK    | MANAGER   | 1995-06-05 | 40000.00 |       NULL | 1005 |   30 |
|  1002 | JOHN     | SALESMAN  | 1993-08-02 | 12000.00 |    1200.00 | 1003 |   10 |
|  1003 | BALLEY   | MANAGER   | 1991-01-10 | 42000.00 |       NULL | 1005 |   10 |
|  1004 | SMITH    | CLERK     | 1998-03-26 | 10000.00 |       0.00 | 1001 |   30 |
|  1005 | ALASTAIR | PRESIDENT | 1994-11-08 | 65000.00 |       NULL | NULL |   20 |
|  1006 | STEVE    | ANALYST   | 1996-11-18 | 30000.00 |       NULL | 1003 |   40 |
|  1007 | JOE      | SALESMAN  | 1996-09-18 | 30000.00 |   12045.00 | 1006 |   40 |
|  1008 | NATHAN   | CLERK     | 2004-11-06 | 10000.00 |   15000.00 | 1003 |   10 |
|  1009 | BRUCE    | CLERK     | 2005-10-24 | 12000.00 |   20000.00 | 1003 |   10 |
+-------+----------+-----------+------------+----------+------------+------+------+
QUERY:
mysql> SELECT
    -> SUM(SALARY) AS TOTAL_SAL,
    -> MAX(SALARY) AS MAX_SAL,
    -> MIN(SALARY) AS MIN_SAL,
    -> AVG(SALARY) AS AVG_SAL
    -> , JOB
    -> FROM EMP
    -> WHERE DPT=10
    -> GROUP BY JOB;
OUTPUT:
+-----------+----------+----------+--------------+----------+
| TOTAL_SAL | MAX_SAL  | MIN_SAL  | AVG_SAL      | JOB      |
+-----------+----------+----------+--------------+----------+
|  12000.00 | 12000.00 | 12000.00 | 12000.000000 | SALESMAN |
|  42000.00 | 42000.00 | 42000.00 | 42000.000000 | MANAGER  |
|  22000.00 | 12000.00 | 10000.00 | 11000.000000 | CLERK    |
+-----------+----------+----------+--------------+----------+
3 rows in set (0.00 sec)

PROMPT 17
INPUT:
mysql> SELECT * FROM EMP;
+-------+----------+-----------+------------+----------+------------+------+------+
| EMPNO | ENAME    | JOB       | HIREDATE   | SALARY   | COMMISSION | MGR  | DPT  |
+-------+----------+-----------+------------+----------+------------+------+------+
|  1001 | STARK    | MANAGER   | 1995-06-05 | 40000.00 |       NULL | 1005 |   30 |
|  1002 | JOHN     | SALESMAN  | 1993-08-02 | 12000.00 |    1200.00 | 1003 |   10 |
|  1003 | BALLEY   | MANAGER   | 1991-01-10 | 42000.00 |       NULL | 1005 |   10 |
|  1004 | SMITH    | CLERK     | 1998-03-26 | 10000.00 |       0.00 | 1001 |   30 |
|  1005 | ALASTAIR | PRESIDENT | 1994-11-08 | 65000.00 |       NULL | NULL |   20 |
|  1006 | STEVE    | ANALYST   | 1996-11-18 | 30000.00 |       NULL | 1003 |   40 |
|  1007 | JOE      | SALESMAN  | 1996-09-18 | 30000.00 |   12045.00 | 1006 |   40 |
|  1008 | NATHAN   | CLERK     | 2004-11-06 | 10000.00 |   15000.00 | 1003 |   10 |
|  1009 | BRUCE    | CLERK     | 2005-10-24 | 12000.00 |   20000.00 | 1003 |   10 |
|  1010 | DAVID    | ANALYST   | 2003-06-20 | 32000.00 |    5000.00 | 1001 |   30 |
+-------+----------+-----------+------------+----------+------------+------+------+
10 rows in set (0.00 sec)
QUERY:
mysql> SELECT SUM(E.SALARY),MAX(E.SALARY),MIN(E.SALARY),AVG(E.SALARY),JOB FROM EMP E 
       WHERE DPT=10 
       GROUP BY JOB 
       HAVING AVG(SALARY)>12000;
OUTPUT:
+---------------+---------------+---------------+---------------+---------+
| SUM(E.SALARY) | MAX(E.SALARY) | MIN(E.SALARY) | AVG(E.SALARY) | JOB     |
+---------------+---------------+---------------+---------------+---------+
|      42000.00 |      42000.00 |      42000.00 |  42000.000000 | MANAGER |
+---------------+---------------+---------------+---------------+---------+
1 row in set (0.00 sec)
PROMPT 18
INPUT:
+-------+----------+-----------+------------+----------+------------+------+------+
| EMPNO | ENAME    | JOB       | HIREDATE   | SALARY   | COMMISSION | MGR  | DPT  |
+-------+----------+-----------+------------+----------+------------+------+------+
|  1001 | STARK    | MANAGER   | 1995-06-05 | 40000.00 |       NULL | 1005 |   30 |
|  1002 | JOHN     | SALESMAN  | 1993-08-02 | 40000.00 |   10000.00 | 1003 |   10 |
|  1003 | BALLEY   | MANAGER   | 1991-01-10 | 42000.00 |       NULL | 1005 |   10 |
|  1004 | SMITH    | CLERK     | 1998-03-26 | 10000.00 |       0.00 | 1001 |   30 |
|  1005 | ALASTAIR | PRESIDENT | 1994-11-08 | 65000.00 |       NULL | NULL |   20 |
|  1006 | STEVE    | ANALYST   | 1996-11-18 | 30000.00 |       NULL | 1003 |   40 |
|  1007 | JOE      | SALESMAN  | 1996-09-18 | 30000.00 |   12045.00 | 1006 |   40 |
|  1008 | NATHAN   | CLERK     | 2004-11-06 | 10000.00 |   15000.00 | 1003 |   10 |
|  1009 | BRUCE    | CLERK     | 2005-10-24 | 12000.00 |   20000.00 | 1003 |   10 |
|  1010 | DAVID    | ANALYST   | 2003-06-20 | 32000.00 |    5000.00 | 1001 |   30 |
+-------+----------+-----------+------------+----------+------------+------+------+
QUERY:
mysql> SELECT MAX(SALARY) HIGHEST_SALARY, MIN(SALARY) SMALLEST_SALARY, MAX(SALARY)-MIN(SALARY) DIFF FROM EMP ;
OUTPUT:
+----------------+-----------------+----------+
| HIGHEST_SALARY | SMALLEST_SALARY | DIFF     |
+----------------+-----------------+----------+
|       65000.00 |        10000.00 | 55000.00 |
+----------------+-----------------+----------+
1 row in set (0.00 sec)
